# #######################
# # Relay Configuration #
# #######################
# This config file only applies for carbon relays, that is
# daemons whose WORKFLOW ends in 'relay'.
#
# RELAY_METHOD can be one of the following:
#   relay-rules
#     Use relay-rules.conf to route metrics to destinations based on pattern rules
#   consistent-hashing
#     Use consistent-hashing for even distribution of metrics between destinations
#   aggregated-consistent-hashing
#     Use consistent-hashing but take into account an aggregation-rules.conf
#     shared by downstream carbon-aggregator daemons. This will ensure that all
#     metrics that map to a given aggregation rule are sent to the same
#     carbon-aggregator instance.
#     Enable this for carbon-relays that send to a group of carbon-aggregators
#
#RELAY_METHOD = consistent-hashing
#RELAY_METHOD = aggregated-consistent-hashing
RELAY_METHOD = relay-rules

# If you use consistent-hashing you may want to add redundancy
# of your data by replicating every datapoint to more than
# one machine. This has no effect with relay-rules.
REPLICATION_FACTOR = 1

# This is a list of carbon daemons we will send any relayed or
# generated metrics to. The default provided would send to a single
# carbon-cache instance on the default port. However if you
# use multiple carbon-cache instances then it would look like this:
#
# DESTINATIONS = 127.0.0.1:2004:cache0, 127.0.0.1:2104:cache1
#
# The general form is IP:PORT:INSTANCE where the :INSTANCE part
# USED TO BE optional but is now required!
#
# Note that if the destinations are all caches then this should
# match the IPs listed in the webapp's CARBONLINK_HOSTS setting
# (though the ports will differ). Order matters!
DESTINATIONS = 127.0.0.1:2004:cache0

# This defines the maximum "message size" between carbon daemons.
# You shouldn't need to tune this unless you really know what you're doing.
MAX_DATAPOINTS_PER_MESSAGE = 500
MAX_QUEUE_SIZE = 10000

# The maximum number of seconds to pause to allow the queue to fill enough to send
# more efficient messages
MAX_SEND_PAUSE = 1
# The maximum rate the queue will flush in messages per second
MAX_QUEUE_FLUSH_RATE = 10000000

# QUEUE_FULL_BEHAVIOR = 'drop'
# QUEUE_FULL_BEHAVIOR = 'block'
# QUEUE_FULL_BEHAVIOR = 'backup_server'
QUEUE_FULL_BEHAVIOR = 'shrink'

